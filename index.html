<!DOCTYPE html>
<html>
<head>
    <style>
      * {
  font-family: 'Poppins', sans-serif;
}
.icon {
    background: url('icons/chevron-down-1.png');
    height: 20px;
    width: 20px;
    /* Other styles here */
}
      body {
        background-color: #f4f4f9;
        color: #333333;
        margin: 0;
        padding: 0;
      }
      .header {
        display: flex;
        width: 100%; /* Use full width */
        height: 60px;
        padding: 0px 20px; /* Consistent padding */
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid var(--line, #525252);
        background: #fff;
        box-shadow: 0px 4px 4px 0px rgba(0, 0, 0, 0.12);
      }
      .logo-title-container {
        display: flex;
        align-items: center;
        gap: 12px; /* Increased gap for better spacing */
      }

      .logo {
        display: flex;
        width: 140px;
        height: 40px;
        justify-content: center;
        align-items: center;
      }
      .divider {
        width: 1px;
        height: 20px; /* Match height with logo */
        background: #333333;
      }
      .header-title {
        color: #333333;
        font-size: 20px;
        font-weight: 700;
        line-height: 24px;
        word-wrap: break-word;
      }
      .search-input {
        color: rgba(51, 51, 51, 0.75);
        font-size: 14px;
        font-family: Roboto;
        font-weight: 400;
        line-height: 18px;
        word-wrap: break-word;
        padding: 8px 40px;        
        }
        .search-container {
            position: relative;
        }
      .search-input:focus {
        outline: none;
        border-color: #7f7f7f;
        background-color: #ffffff;
      }
      .search-box .bi-search {
        position: absolute;
        right: 0.75rem;
        top: 50%;
        transform: translateY(-50%);
        color: #6c757d;
      }
      .search-icon {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #666;
      }

      
      .left-panel {
  width: 250px;
  background-color: #ffffff;
  box-shadow: 4px 0px 4px 0px rgba(0, 0, 0, 0.12);
  padding: 16px 0;
}

.left-panel tag {
  display: block;
  padding: 12px 16px;
  color: rgba(51, 51, 51, 0.80);
  font-size: 16px;
  font-weight: 500;
  cursor: pointer;
  transition: color 0.3s ease;
}

.left-panel tag:hover,
.left-panel tag.active {
  color: #EC4D08;
}

.left-panel ul {
  list-style: none;
  margin: 0;
  padding: 0;
  display: none;
}

.left-panel tag.active + ul {
  display: block;
}

.left-panel li {
  padding: 8px 16px;
  color: rgba(51, 51, 51, 0.80);
  font-size: 14px;
  cursor: pointer;
  transition: color 0.3s ease;
  display: flex;
  align-items: center;
  gap: 8px;
}

.left-panel li:hover {
  color: #EC4D08;
}

.left-panel li i {
  font-size: 12px;
}     


#appsTable {
    width: 100%;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-left: 20px;
}
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        tr:nth-child(even) {
            background-color: #DDDDDD; /* Light background for even rows */
        }
        tr:hover {
            background-color: #f5f5f5;
            cursor: pointer;
        }
        .tag {
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 12px;
  white-space: nowrap;
}
.tag:nth-child(1) { background-color: #4CAF50; } /* Green */
        .tag:nth-child(2) { background-color: #2196F3; } /* Blue */
        .tag:nth-child(3) { background-color: #FFBB04; } /* Orange */
        .tag:nth-child(4) { background-color: #F44336; }
        .checkbox-cell {
            width: 40px;
        }
        
        .create-cards-btn {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .create-cards-btn:hover {
            background-color: #45a049;
        }
        .link {
            color: #2196F3; /* Highlighted link color */
            text-decoration: underline;
        }
        .content {
        display: flex;
      }
    </style>
</head>
<body>
  <div class="header">
    <div class="logo-title-container">
      <img
        src="https://raw.githubusercontent.com/Harshith-Vajinepalli/screenshots_of_pages/main/Stv_Primary_Colour_RGB.jpg"
        alt="Logo"
        class="logo"
        width="122"
        height="32"
        id="headerLogo"
      />
      <div class="divider"></div>
              
      <div class="header-title">Solution Collection</div>
    </div>
    <div class="search-container">
      <i class="bi bi-search search-icon"></i>
      <input
        type="text"
        id="searchInput"
        class="search-input"
        placeholder="Search for apps ..."
      />
      <button id="createCardsBtn" class="create-cards-btn">Create Selected Cards Page</button>
    </div>
  </div>

    <div class="content"style="display: flex; flex-grow: 1;">
        <div class="left-panel" id="leftPanel"></div>
        <div style="flex-grow: 1;">
        <table id="appsTable">
                <thead>
                    <tr style="background-color: #DDDDDD;">
                        <th class="checkbox-cell"></th>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Client</th>
                        <th>Tags</th>
                        <th>Link</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
</div>
    <script>
        // Keep your existing code for init(), parseAppsCSV(), and parseTagsCSV()
         // Global variables
      let apps = [];
      let categories = [];
      let selectedRows = new Set();
      // Initialize app
      async function init() {
        // showLoading();
        try {
          // Fetch both CSV files
          const [appsResponse, tagsResponse] = await Promise.all([
            fetch(
              'https://raw.githubusercontent.com/Harshith-Vajinepalli/screenshots_of_pages/main/App%20tools%20-%20Demos1.csv',
            ),
            fetch(
              'https://raw.githubusercontent.com/Harshith-Vajinepalli/screenshots_of_pages/main/demos%20sheet%20of%20frontend%20-%20Tags.csv',
            ),
          ]);

          const [appsText, tagsText] = await Promise.all([
            appsResponse.text(),
            tagsResponse.text(),
          ]);

          // Parse CSVs
          apps = parseAppsCSV(appsText);
          categories = parseTagsCSV(tagsText);

          // Display content
          displayApps(apps);
          setupCategories();

        //   hideLoading();
        } catch (error) {
          showError('Failed to load data: ' + error.message);
        }
      }
function parseAppsCSV(csv) {
        const lines = csv.split(/\r?\n/);
        return lines
          .slice(1) // Skip header row
          .filter((line) => line.trim() !== '') // Filter out empty lines
          .map((line) => {
            const columns = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
            // Only create object if we have at least the required fields
            if (columns.length >= 9) {
              return {
                serialNo: columns[0]?.trim(),
                name: columns[1]?.replace(/"/g, '').trim(),
                client: columns[2]?.replace(/"/g, '').trim(),
                description: columns[3]?.replace(/"/g, '').trim(),
                comments: columns[4]?.replace(/"/g, '').trim(),
                tags: columns[5]?.replace(/"/g, '').trim().split(',').map(tag => tag.trim()),
                link: columns[6]?.replace(/"/g, '').trim(),
                additionalPrompt: columns[7]?.replace(/"/g, '').trim(),
                image: columns[8]?.replace(/"/g, '').trim(),
              };
            }
            return null;
          })
          .filter((item) => item !== null); // Filter out any null entries
      }
      function parseTagsCSV(csv) {
        const result = [];
        const lines = csv.match(/(?:[^\n"]|"[^"]*")+/g); // Match lines, including quoted strings

        let currentCategory = null;

        lines.forEach((line) => {
          const [category, ...subCategories] = line
            .split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/)
            .map((s) => s.trim()); // Split by comma not inside quotes
          const subCategoryList = subCategories
            .join(',')
            .replace(/(^"|"$)/g, '')
            .split(',')
            .map((s) => s.trim()); // Join and clean subcategories

          if (category) {
            if (currentCategory) {
              result.push(currentCategory);
            }
            currentCategory = {
              name: category,
              subCategories: subCategoryList,
            };
          }
        });

        if (currentCategory) {
          result.push(currentCategory);
        }
        return result;
      }
      
        // Modified displayApps function
        function displayApps(appsToShow) {
    const tbody = document.querySelector('#appsTable tbody');
    tbody.innerHTML = '';

    appsToShow.forEach((app) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td class="checkbox-cell">
                <input type="checkbox" class="row-checkbox" data-name="${app.name}">
            </td>
            <td>${app.name}</td>
            <td>${app.description}</td>
            <td>${app.client}</td>
            <td>${app.tags.map(tag => 
                `<span class="tag">${tag}</span>`
            ).join('')}</td>
            <td><a href="${app.link}" target="_blank" class="link">View</a></td>
        `;

        // Check if this row was previously selected
        const checkbox = row.querySelector('.row-checkbox');
        if (selectedRows.has(app.name)) {
            checkbox.checked = true;
        }

        // Add click handler for the entire row
        row.addEventListener('click', (e) => {
            if (!e.target.matches('a')) {
                const checkbox = row.querySelector('.row-checkbox');
                checkbox.checked = !checkbox.checked;
                
                // Update selectedRows Set
                if (checkbox.checked) {
                    selectedRows.add(app.name);
                } else {
                    selectedRows.delete(app.name);
                }
            }
        });

        // Prevent checkbox click from triggering row click
        row.querySelector('.row-checkbox').addEventListener('click', (e) => {
            e.stopPropagation();
            if (e.target.checked) {
                selectedRows.add(app.name);
            } else {
                selectedRows.delete(app.name);
            }
        });

        tbody.appendChild(row);
    });
}
        // Add handler for Create Selected Cards button
        document.getElementById('createCardsBtn').addEventListener('click', () => {
            const selectedRows = [];
            document.querySelectorAll('.row-checkbox:checked').forEach(checkbox => {
                const row = checkbox.closest('tr');
                const rowData = {
                    name: row.cells[1].textContent,
                    description: row.cells[2].textContent,
                    client: row.cells[3].textContent,
                    tags: row.cells[4].textContent,
                    link: row.cells[5].querySelector('a').href
                };
                selectedRows.push(rowData);
            });

            // Store selected data in localStorage or pass it to the next page
            localStorage.setItem('selectedCards', JSON.stringify(selectedRows));
            // Navigate to the second page
            window.location.href = 'd.html';
        });
        function setupCategories() {
        const panel = document.getElementById('leftPanel');
        panel.innerHTML = '';

        categories.forEach((category) => {
          const title = document.createElement('tag');
          title.innerHTML = `${category.name}`;

          const list = document.createElement('ul');
          list.style.display = 'none';
          category.subCategories.forEach((subCategory) => {
            const item = document.createElement('li');
            item.innerHTML = ` ${subCategory}`;
            item.addEventListener('click', () => filterByTag(subCategory));
            list.appendChild(item);
          });

          title.addEventListener('click', () => {
            title.classList.toggle('active');
            list.style.display = list.style.display === 'none' ? 'block' : 'none';
          });

          panel.appendChild(title);
          panel.appendChild(list);
        });
      }

      function filterByTag(tag) {
        const filtered = apps.filter((app) => app.tags?.toLowerCase().includes(tag.toLowerCase()));
        displayApps(filtered);
      }
    //   function showLoading() {
    //     document.getElementById('loading').classList.remove('d-none');
    //   }

    //   function hideLoading() {
    //     document.getElementById('loading').classList.add('d-none');
    //   }

      function showError(message) {
        const error = document.getElementById('error');
        error.textContent = message;
        error.classList.remove('d-none');
        hideLoading();
        setTimeout(() => error.classList.add('d-none'), 5000);
      }
      document.getElementById('searchInput').addEventListener('input', (e) => {
    const searchTerm = e.target.value.toLowerCase();
    const filtered = apps.filter(
        (app) =>
            app.name.toLowerCase().includes(searchTerm) ||
            app.description.toLowerCase().includes(searchTerm) ||
            app.tags?.toLowerCase().includes(searchTerm),
    );
    displayApps(filtered);
});

// Modify the displayApps function to ensure selected rows remain selected
function displayApps(appsToShow) {
    const tbody = document.querySelector('#appsTable tbody');
    tbody.innerHTML = '';

    appsToShow.forEach((app) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td class="checkbox-cell">
                <input type="checkbox" class="row-checkbox" data-name="${app.name}">
            </td>
            <td>${app.name}</td>
            <td>${app.description}</td>
            <td>${app.client}</td>
            <td>${app.tags.map(tag => 
                `<span class="tag">${tag}</span>`
            ).join('')}</td>
            <td><a href="${app.link}" target="_blank" class="link">View</a></td>
        `;

        // Check if this row was previously selected
        const checkbox = row.querySelector('.row-checkbox');
        if (selectedRows.has(app.name)) {
            checkbox.checked = true;
        }

        // Add click handler for the entire row
        row.addEventListener('click', (e) => {
            if (!e.target.matches('a')) {
                const checkbox = row.querySelector('.row-checkbox');
                checkbox.checked = !checkbox.checked;
                
                // Update selectedRows Set
                if (checkbox.checked) {
                    selectedRows.add(app.name);
                } else {
                    selectedRows.delete(app.name);
                }
            }
        });

        // Prevent checkbox click from triggering row click
        row.querySelector('.row-checkbox').addEventListener('click', (e) => {
            e.stopPropagation();
            if (e.target.checked) {
                selectedRows.add(app.name);
            } else {
                selectedRows.delete(app.name);
            }
        });

        tbody.appendChild(row);
    });
}
      /*document.getElementById('searchInput').addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        const filtered = apps.filter(
          (app) =>
            app.name.toLowerCase().includes(searchTerm) ||
            app.description.toLowerCase().includes(searchTerm) ||
            app.tags?.toLowerCase().includes(searchTerm),
        );
        displayApps(filtered);
      });
      // Add this function to reset filters
      function resetFilters() {
        // Reset search input
        document.getElementById('searchInput').value = '';

        // Display all apps
        displayApps(apps);

        // Reset category selections in left panel
        document.querySelectorAll('.left-panel h3').forEach((title) => {
          title.classList.remove('active');
          const list = title.nextElementSibling;
          if (list) {
            list.style.display = 'none';
          }
        });
      }*/

      // Add this in your init() function or at the end of your script
      // document.getElementById('headerLogo').addEventListener('click', resetFilters);
      // Initialize the app
      window.addEventListener('load', init);
    
        // Initialize the app
        init();
    </script>
</body>
</html>
